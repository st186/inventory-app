import{c as L,r as p,j as e,_ as I,Z as H,P,aT as U,U as V,b6 as _,aj as z,b7 as B,aR as Q,b8 as Y,b9 as Z}from"./index-BWZpdZV9.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],J=L("hash",G);function ee({context:n,stores:j,employees:T,onRefreshStores:K}){const[S,b]=p.useState(!1),[D,N]=p.useState(!1),[W,E]=p.useState({}),[x,v]=p.useState({name:"",location:"",productionHeadId:""}),[r,i]=p.useState({fromHouseId:"",toHouseId:"",quantities:{chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0}}),k=T.filter(s=>s.designation==="production_incharge");p.useEffect(()=>{q()},[n.productionData,n.productionRequests,n.productionHouses]);const q=async()=>{if(!n.user?.accessToken||!n.productionHouses)return;const s={},o=new Date().toISOString().substring(0,7);for(const c of n.productionHouses)try{const d=await(void 0)(n.user.accessToken,c.id,"production_house");let t={};d?.record&&d.record.date.substring(0,7)===o?d.record.items.forEach(a=>{const y=n.inventoryItems?.find(m=>m.id===a.itemId||m.name===a.itemId);if(y){const f=y.name.replace(/_([a-z])/g,w=>w[1].toUpperCase()).replace(/Momo(s)?$/i,"");t[f]=a.actualQuantity}}):t={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0};const l=(n.productionData||[]).filter(a=>a.productionHouseId===c.id&&a.date.substring(0,7)===o&&a.approvalStatus==="approved"),g={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0};l.forEach(a=>{const y=n.inventoryItems?.find(m=>m.id===a.itemId);if(y){const f=y.name.replace(/_([a-z])/g,w=>w[1].toUpperCase()).replace(/Momo(s)?$/i,"");g[f]=(g[f]||0)+a.quantityProduced}});const u=(n.productionRequests||[]).filter(a=>a.productionHouseId===c.id&&a.status==="fulfilled"&&a.fulfilledDate&&a.fulfilledDate.substring(0,7)===o),h={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0};u.forEach(a=>{h.chicken+=a.chickenMomos||a.chicken||0,h.chickenCheese+=a.chickenCheeseMomos||a.chickenCheese||0,h.veg+=a.vegMomos||a.veg||0,h.cheeseCorn+=a.cheeseCornMomos||a.cheeseCorn||0,h.paneer+=a.paneerMomos||a.paneer||0,h.vegKurkure+=a.vegKurkureMomos||a.vegKurkure||0,h.chickenKurkure+=a.chickenKurkureMomos||a.chickenKurkure||0});const C={};Object.keys(t).forEach(a=>{C[a]=(t[a]||0)+(g[a]||0)-(h[a]||0)}),s[c.id]=C}catch(d){console.error(`Error calculating stock for ${c.name}:`,d),s[c.id]={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0}}E(s)},F=async s=>{s.preventDefault();try{await n.addProductionHouse({name:x.name,location:x.location,productionHeadId:x.productionHeadId||null,inventory:{chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0},createdBy:n.user?.employeeId||n.user?.email||"unknown"}),alert("Production house created successfully!"),b(!1),v({name:"",location:"",productionHeadId:""})}catch(o){console.error("Error creating production house:",o),alert("Failed to create production house. Please try again.")}},R=async(s,o)=>{try{if(!n.user?.accessToken)return;await Y(n.user.accessToken,s,o),await n.updateProductionHouse(s,{productionHeadId:o}),alert("Production head assigned successfully! Please refresh the page for changes to take effect.")}catch(c){console.error("Error assigning production head:",c),alert("Failed to assign production head. Please try again.")}},$=async(s,o)=>{try{if(!n.user?.accessToken)return;await Z(n.user.accessToken,s,o),alert("Store assigned to production house successfully!"),K()}catch(c){console.error("Error assigning store:",c),alert("Failed to assign store. Please try again.")}},M=async(s,o)=>{if(window.confirm(`Are you sure you want to delete "${o}"?

This action cannot be undone.`))try{await n.deleteProductionHouse(s),alert("Production house deleted successfully!")}catch(d){console.error("Error deleting production house:",d),alert("Failed to delete production house. Please try again.")}},O=async()=>{if(!r.fromHouseId||!r.toHouseId){alert("Please select both source and destination production houses");return}if(r.fromHouseId===r.toHouseId){alert("Source and destination cannot be the same");return}const s=Object.values(r.quantities).reduce((t,l)=>t+l,0);if(s===0){alert("Please enter quantities to transfer");return}const o=n.productionHouses.find(t=>t.id===r.fromHouseId),c=n.productionHouses.find(t=>t.id===r.toHouseId);if(window.confirm(`Transfer ${s} pieces from "${o?.name}" to "${c?.name}"?

This action cannot be undone.`))try{if(!n.user?.accessToken){alert("Not authenticated");return}await B(n.user.accessToken,r.fromHouseId,r.toHouseId,r.quantities);const t=await Q(n.user.accessToken);n.setProductionHouses(t),alert("Inventory transferred successfully!"),N(!1),i({fromHouseId:"",toHouseId:"",quantities:{chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0}})}catch(t){console.error("Error transferring inventory:",t),alert(`Failed to transfer inventory: ${t.message||"Unknown error"}`)}},A=()=>{const s=n.productionHouses.find(o=>o.id===r.fromHouseId);if(!s){alert("Please select a source production house first");return}i({...r,quantities:{chicken:s.inventory.chicken,chickenCheese:s.inventory.chickenCheese,veg:s.inventory.veg,cheeseCorn:s.inventory.cheeseCorn,paneer:s.inventory.paneer,vegKurkure:s.inventory.vegKurkure,chickenKurkure:s.inventory.chickenKurkure}})};return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl text-gray-900 flex items-center gap-3",children:[e.jsx(I,{className:"w-8 h-8 text-purple-600"}),"Production House Management"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Manage production houses, inventory, and store mappings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5"}),"Transfer Inventory"]}),e.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"New Production House"]})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[e.jsx("h2",{className:"text-xl text-gray-900 mb-4",children:"Create New Production House"}),e.jsxs("form",{onSubmit:F,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:x.name,onChange:s=>v({...x,name:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., Main Production House"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Location *"}),e.jsx("input",{type:"text",required:!0,value:x.location,onChange:s=>v({...x,location:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g., Sector 21, Dwarka"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Production Head (Optional)"}),e.jsxs("select",{value:x.productionHeadId,onChange:s=>v({...x,productionHeadId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Production Head"}),k.map(s=>e.jsxs("option",{value:s.employeeId,children:[s.name," (",s.employeeId,")"]},s.employeeId))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{b(!1),v({name:"",location:"",productionHeadId:""})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"Create"})]})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("h2",{className:"text-2xl text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx(H,{className:"w-6 h-6 text-blue-600"}),"Transfer Inventory Between Production Houses"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Source Production House *"}),e.jsxs("select",{value:r.fromHouseId,onChange:s=>i({...r,fromHouseId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select source..."}),n.productionHouses.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.location]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-2",children:"Destination Production House *"}),e.jsxs("select",{value:r.toHouseId,onChange:s=>i({...r,toHouseId:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select destination..."}),n.productionHouses.filter(s=>s.id!==r.fromHouseId).map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",s.location]},s.id))]})]})]}),r.fromHouseId&&(()=>{const s=n.productionHouses.find(o=>o.id===r.fromHouseId);return s?e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:[e.jsxs("h3",{className:"text-sm text-gray-900 mb-3",children:["Available Stock at ",s.name]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2",children:[e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Chicken"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.chicken})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Chicken Cheese"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.chickenCheese})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Veg"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.veg})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Cheese Corn"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.cheeseCorn})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Paneer"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.paneer})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Veg Kurkure"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.vegKurkure})]}),e.jsxs("div",{className:"bg-white rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Chicken Kurkure"}),e.jsx("div",{className:"text-sm text-gray-900",children:s.inventory.chickenKurkure})]})]})]}):null})(),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm text-gray-900",children:"Transfer Quantities"}),e.jsx("button",{type:"button",onClick:A,className:"px-3 py-1.5 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700 transition-colors",children:"Transfer All"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Chicken"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.chicken,onChange:s=>i({...r,quantities:{...r.quantities,chicken:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Chicken Cheese"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.chickenCheese,onChange:s=>i({...r,quantities:{...r.quantities,chickenCheese:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Veg"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.veg,onChange:s=>i({...r,quantities:{...r.quantities,veg:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Cheese Corn"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.cheeseCorn,onChange:s=>i({...r,quantities:{...r.quantities,cheeseCorn:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Paneer"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.paneer,onChange:s=>i({...r,quantities:{...r.quantities,paneer:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Veg Kurkure"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.vegKurkure,onChange:s=>i({...r,quantities:{...r.quantities,vegKurkure:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-700 mb-1",children:"Chicken Kurkure"}),e.jsx("input",{type:"number",min:"0",value:r.quantities.chickenKurkure,onChange:s=>i({...r,quantities:{...r.quantities,chickenKurkure:parseInt(s.target.value)||0}}),className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0"})]})]})]}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 border-2 border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-900",children:"Total Pieces to Transfer:"}),e.jsx("span",{className:"text-2xl text-green-600",children:Object.values(r.quantities).reduce((s,o)=>s+o,0)})]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{N(!1),i({fromHouseId:"",toHouseId:"",quantities:{chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0}})},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:O,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Transfer Inventory"})]})]})]})}),e.jsx("div",{className:"space-y-6",children:n.productionHouses.length===0?e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[e.jsx(I,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl text-gray-900 mb-2",children:"No Production Houses Yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first production house to get started"}),e.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors inline-flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"Create Production House"]})]}):n.productionHouses.map(s=>{const o=k.find(t=>t.employeeId===s.productionHeadId),c=j.filter(t=>t.productionHouseId===s.id),d=Object.values(s.inventory).reduce((t,l)=>t+l,0);return e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl text-gray-900 mb-2",children:s.name}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm font-mono bg-purple-100 text-purple-800 px-2 py-1 rounded",children:["ID: ",s.id]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),e.jsx("span",{children:s.location})]}),o&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsxs("span",{children:[o.name," (",o.employeeId,")"]})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Total Inventory"}),e.jsxs("div",{className:"text-2xl text-purple-600",children:[d," pcs"]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-purple-600"}),"Current Stock Levels"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[e.jsxs("div",{className:"bg-red-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Chicken"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.chicken})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Chicken Cheese"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.chickenCheese})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Veg"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.veg})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Cheese Corn"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.cheeseCorn})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Paneer"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.paneer})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Veg Kurkure"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.vegKurkure})]}),e.jsxs("div",{className:"bg-pink-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-1",children:"Chicken Kurkure"}),e.jsx("div",{className:"text-lg text-gray-900",children:s.inventory.chickenKurkure})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm text-gray-700",children:"Assign Production Head"}),o&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:async()=>{if(n.user?.accessToken)try{const l=await(await fetch("https://xssxnhrzxvtejavoqgwg.supabase.co/functions/v1/make-server-c2dd9b9d/production",{headers:{Authorization:`Bearer ${n.user.accessToken}`}})).json();console.log("ðŸ” ALL PRODUCTION RECORDS:",l.production);const g=l.production.filter(u=>u.storeId==="STORE-1766938921191-9LCH05"||u.productionHouseId==="STORE-1766938921191-9LCH05"||u.productionHouseId===s.id);console.log("ðŸ“Š Records related to this production house:",g),console.log("ðŸ“Š Current Production House ID:",s.id),console.log("ðŸ“Š Records by productionHouseId:"),g.forEach(u=>{console.log(`  - Record ${u.id.slice(0,8)} (${u.date}): storeId=${u.storeId}, productionHouseId=${u.productionHouseId}`)}),alert(`Found ${g.length} records related to this production house.

Check console for details (F12).`)}catch(t){console.error("Error fetching production data:",t),alert("Failed to fetch data. Check console.")}},className:"px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",title:"Show current production records in console for debugging",children:"ðŸ” Debug Records"}),e.jsx("button",{onClick:async()=>{if(!n.user?.accessToken)return;const t=window.prompt(`Enter the OLD storeId to fix (the wrong ID that production records currently have):

For example: STORE-1766938921191-9LCH05

This will update all production records from that ID to the correct production house ID: ${s.id}`);if(!(!t||t.trim()==="")&&window.confirm(`Fix production records with OLD ID: ${t}?

This will update them to use the correct production house ID: ${s.id}`))try{const l=await _(n.user.accessToken,s.id,t.trim());alert(`âœ… Fixed ${l.updatedCount} production records!

Please refresh the page.`),window.location.reload()}catch(l){console.error("Error fixing records:",l),alert("Failed to fix records. Please try again.")}},className:"px-3 py-1.5 bg-orange-600 text-white text-sm rounded-lg hover:bg-orange-700 transition-colors",title:"Fix old production records that have wrong productionHouseId",children:"ðŸ”§ Fix Old Records"})]})]}),e.jsxs("select",{value:s.productionHeadId||"",onChange:t=>R(s.id,t.target.value),className:"w-full md:w-96 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"No Production Head Assigned"}),k.map(t=>e.jsxs("option",{value:t.employeeId,children:[t.name," (",t.employeeId,")"]},t.employeeId))]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-gray-900 mb-3",children:["Mapped Stores (",c.length,")"]}),c.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:c.map(t=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.location})]})},t.id))}):e.jsx("p",{className:"text-gray-500 text-sm",children:"No stores mapped to this production house yet"})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>M(s.id,s.name),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"Delete Production House"]})})]},s.id)})}),n.productionHouses.length>0&&e.jsxs("div",{className:"mt-8 bg-yellow-50 rounded-xl p-6 border-2 border-yellow-200",children:[e.jsx("h3",{className:"text-lg text-gray-900 mb-4",children:"âš ï¸ Unmapped Stores"}),j.filter(s=>!s.productionHouseId).length===0?e.jsx("p",{className:"text-gray-600",children:"All stores are mapped to production houses âœ“"}):e.jsx("div",{className:"space-y-3",children:j.filter(s=>!s.productionHouseId).map(s=>e.jsxs("div",{className:"bg-white rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-600",children:s.location})]}),e.jsxs("select",{onChange:o=>o.target.value&&$(s.id,o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",defaultValue:"",children:[e.jsx("option",{value:"",children:"Assign to Production House"}),n.productionHouses.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]},s.id))})]})]})}export{ee as ProductionHouseManagement};
