import{c as q,ba as C,bb as G,bc as te,bd as Q,be as _e,bf as J,bg as Le,bh as ue,bi as ze,bj as Fe,bk as ee,bl as Be,bm as He,r as T,bn as Ge,bo as Ne,bp as We,bq as ke,br as Ue,bs as Ae,bt as Re,bu as Ve,j as e,C as pe,h as Qe,at as ae,aB as Ee,av as ge,aw as xe,ax as se,ay as fe,az as re,aC as ne,au as Ye,aA as Ze,T as $e,ab as qe,Z as ie,_ as we,a6 as Xe,a9 as Je,B as et,bv as tt,bw as at,F as st}from"./index-RP5sFzS9.js";import{C as R,B as oe}from"./badge-DPMKMFmx.js";import{C as rt}from"./chevron-up-BmpRtKF5.js";import{T as nt}from"./trending-down-DL1x9TwU.js";import{S as it}from"./send-Dn-athx5.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ct=q("arrow-right",ot);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],Se=q("award",lt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],ut=q("info",dt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],be=q("target",mt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],ve=q("trophy",ht);var pt=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function Y(a){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(a)}function gt(a,t){if(a==null)return{};var r=xt(a,t),s,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(a);for(n=0;n<c.length;n++)s=c[n],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(a,s)&&(r[s]=a[s])}return r}function xt(a,t){if(a==null)return{};var r={};for(var s in a)if(Object.prototype.hasOwnProperty.call(a,s)){if(t.indexOf(s)>=0)continue;r[s]=a[s]}return r}function z(){return z=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(a[s]=r[s])}return a},z.apply(this,arguments)}function Pe(a,t){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),r.push.apply(r,s)}return r}function Z(a){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pe(Object(r),!0).forEach(function(s){ft(a,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(r,s))})}return a}function ft(a,t,r){return t=vt(t),t in a?Object.defineProperty(a,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[t]=r,a}function vt(a){var t=yt(a,"string");return Y(t)=="symbol"?t:t+""}function yt(a,t){if(Y(a)!="object"||!a)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var s=r.call(a,t);if(Y(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}var bt=function(t,r,s,n){var c="";return n.forEach(function(l,g){var f=Q(r,s,t,l);g?c+="L ".concat(f.x,",").concat(f.y):c+="M ".concat(f.x,",").concat(f.y)}),c+="Z",c},jt=function(t){var r=t.cx,s=t.cy,n=t.innerRadius,c=t.outerRadius,l=t.polarAngles,g=t.radialLines;if(!l||!l.length||!g)return null;var f=Z({stroke:"#ccc"},G(t,!1));return C.createElement("g",{className:"recharts-polar-grid-angle"},l.map(function(j){var o=Q(r,s,n,j),m=Q(r,s,c,j);return C.createElement("line",z({},f,{key:"line-".concat(j),x1:o.x,y1:o.y,x2:m.x,y2:m.y}))}))},Nt=function(t){var r=t.cx,s=t.cy,n=t.radius,c=t.index,l=Z(Z({stroke:"#ccc"},G(t,!1)),{},{fill:"none"});return C.createElement("circle",z({},l,{className:te("recharts-polar-grid-concentric-circle",t.className),key:"circle-".concat(c),cx:r,cy:s,r:n}))},kt=function(t){var r=t.radius,s=t.index,n=Z(Z({stroke:"#ccc"},G(t,!1)),{},{fill:"none"});return C.createElement("path",z({},n,{className:te("recharts-polar-grid-concentric-polygon",t.className),key:"path-".concat(s),d:bt(r,t.cx,t.cy,t.polarAngles)}))},wt=function(t){var r=t.polarRadius,s=t.gridType;return!r||!r.length?null:C.createElement("g",{className:"recharts-polar-grid-concentric"},r.map(function(n,c){var l=c;return s==="circle"?C.createElement(Nt,z({key:l},t,{radius:n,index:c})):C.createElement(kt,z({key:l},t,{radius:n,index:c}))}))},Te=function(t){var r=t.cx,s=r===void 0?0:r,n=t.cy,c=n===void 0?0:n,l=t.innerRadius,g=l===void 0?0:l,f=t.outerRadius,j=f===void 0?0:f,o=t.gridType,m=o===void 0?"polygon":o,y=t.radialLines,M=y===void 0?!0:y,S=gt(t,pt);return j<=0?null:C.createElement("g",{className:"recharts-polar-grid"},C.createElement(jt,z({cx:s,cy:c,innerRadius:g,outerRadius:j,gridType:m,radialLines:M},S)),C.createElement(wt,z({cx:s,cy:c,innerRadius:g,outerRadius:j,gridType:m,radialLines:M},S)))};Te.displayName="PolarGrid";var me,Me;function St(){if(Me)return me;Me=1;function a(t){return t&&t.length?t[0]:void 0}return me=a,me}var he,Oe;function Pt(){return Oe||(Oe=1,he=St()),he}var Mt=Pt();const Ot=_e(Mt);var Dt=["key"];function W(a){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(a)}function Ct(a,t){if(a==null)return{};var r=At(a,t),s,n;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(a);for(n=0;n<c.length;n++)s=c[n],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(a,s)&&(r[s]=a[s])}return r}function At(a,t){if(a==null)return{};var r={};for(var s in a)if(Object.prototype.hasOwnProperty.call(a,s)){if(t.indexOf(s)>=0)continue;r[s]=a[s]}return r}function ce(){return ce=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(a[s]=r[s])}return a},ce.apply(this,arguments)}function De(a,t){var r=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);t&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),r.push.apply(r,s)}return r}function $(a){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?De(Object(r),!0).forEach(function(s){L(a,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(r,s))})}return a}function Rt(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(a,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(a,Ke(s.key),s)}}function Et(a,t,r){return t&&Ce(a.prototype,t),r&&Ce(a,r),Object.defineProperty(a,"prototype",{writable:!1}),a}function $t(a,t,r){return t=le(t),Tt(a,Ie()?Reflect.construct(t,r||[],le(a).constructor):t.apply(a,r))}function Tt(a,t){if(t&&(W(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return It(a)}function It(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function Ie(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ie=function(){return!!a})()}function le(a){return le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},le(a)}function Kt(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&ye(a,t)}function ye(a,t){return ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,n){return s.__proto__=n,s},ye(a,t)}function L(a,t,r){return t=Ke(t),t in a?Object.defineProperty(a,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[t]=r,a}function Ke(a){var t=_t(a,"string");return W(t)=="symbol"?t:t+""}function _t(a,t){if(W(a)!="object"||!a)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var s=r.call(a,t);if(W(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var B=(function(a){function t(){var r;Rt(this,t);for(var s=arguments.length,n=new Array(s),c=0;c<s;c++)n[c]=arguments[c];return r=$t(this,t,[].concat(n)),L(r,"state",{isAnimationFinished:!1}),L(r,"handleAnimationEnd",function(){var l=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),J(l)&&l()}),L(r,"handleAnimationStart",function(){var l=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),J(l)&&l()}),L(r,"handleMouseEnter",function(l){var g=r.props.onMouseEnter;g&&g(r.props,l)}),L(r,"handleMouseLeave",function(l){var g=r.props.onMouseLeave;g&&g(r.props,l)}),r}return Kt(t,a),Et(t,[{key:"renderDots",value:function(s){var n=this.props,c=n.dot,l=n.dataKey,g=G(this.props,!1),f=G(c,!0),j=s.map(function(o,m){var y=$($($({key:"dot-".concat(m),r:3},g),f),{},{dataKey:l,cx:o.x,cy:o.y,index:m,payload:o});return t.renderDotItem(c,y)});return C.createElement(ue,{className:"recharts-radar-dots"},j)}},{key:"renderPolygonStatically",value:function(s){var n=this.props,c=n.shape,l=n.dot,g=n.isRange,f=n.baseLinePoints,j=n.connectNulls,o;return C.isValidElement(c)?o=C.cloneElement(c,$($({},this.props),{},{points:s})):J(c)?o=c($($({},this.props),{},{points:s})):o=C.createElement(ze,ce({},G(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:s,baseLinePoints:g?f:null,connectNulls:j})),C.createElement(ue,{className:"recharts-radar-polygon"},o,l?this.renderDots(s):null)}},{key:"renderPolygonWithAnimation",value:function(){var s=this,n=this.props,c=n.points,l=n.isAnimationActive,g=n.animationBegin,f=n.animationDuration,j=n.animationEasing,o=n.animationId,m=this.state.prevPoints;return C.createElement(Fe,{begin:g,duration:f,isActive:l,easing:j,from:{t:0},to:{t:1},key:"radar-".concat(o),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var M=y.t,S=m&&m.length/c.length,d=c.map(function(h,N){var u=m&&m[Math.floor(N*S)];if(u){var p=ee(u.x,h.x),b=ee(u.y,h.y);return $($({},h),{},{x:p(M),y:b(M)})}var P=ee(h.cx,h.x),x=ee(h.cy,h.y);return $($({},h),{},{x:P(M),y:x(M)})});return s.renderPolygonStatically(d)})}},{key:"renderPolygon",value:function(){var s=this.props,n=s.points,c=s.isAnimationActive,l=s.isRange,g=this.state.prevPoints;return c&&n&&n.length&&!l&&(!g||!Be(g,n))?this.renderPolygonWithAnimation():this.renderPolygonStatically(n)}},{key:"render",value:function(){var s=this.props,n=s.hide,c=s.className,l=s.points,g=s.isAnimationActive;if(n||!l||!l.length)return null;var f=this.state.isAnimationFinished,j=te("recharts-radar",c);return C.createElement(ue,{className:j},this.renderPolygon(),(!g||f)&&He.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(s,n){return s.animationId!==n.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:n.curPoints}:s.points!==n.curPoints?{curPoints:s.points}:null}},{key:"renderDotItem",value:function(s,n){var c;if(C.isValidElement(s))c=C.cloneElement(s,n);else if(J(s))c=s(n);else{var l=n.key,g=Ct(n,Dt);c=C.createElement(Le,ce({},g,{key:l,className:te("recharts-radar-dot",typeof s!="boolean"?s.className:"")}))}return c}}])})(T.PureComponent);L(B,"displayName","Radar");L(B,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!Ge.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});L(B,"getComposedData",function(a){var t=a.radiusAxis,r=a.angleAxis,s=a.displayedData,n=a.dataKey,c=a.bandSize,l=r.cx,g=r.cy,f=!1,j=[],o=r.type!=="number"?c??0:0;s.forEach(function(y,M){var S=Ne(y,r.dataKey,M),d=Ne(y,n),h=r.scale(S)+o,N=Array.isArray(d)?We(d):d,u=ke(N)?void 0:t.scale(N);Array.isArray(d)&&d.length>=2&&(f=!0),j.push($($({},Q(l,g,u,h)),{},{name:S,value:d,cx:l,cy:g,radius:u,angle:h,payload:y}))});var m=[];return f&&j.forEach(function(y){if(Array.isArray(y.value)){var M=Ot(y.value),S=ke(M)?void 0:t.scale(M);m.push($($({},y),{},{radius:S},Q(l,g,S,y.angle)))}else m.push(y)}),{points:j,isRange:f,baseLinePoints:m}});var Lt=Ue({chartName:"RadarChart",GraphicalChild:B,axisComponents:[{axisType:"angleAxis",AxisComp:Ae},{axisType:"radiusAxis",AxisComp:Re}],formatAxisMap:Ve,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});function zt({context:a,stores:t}){const r=T.useMemo(()=>{const n=new Date;n.setDate(n.getDate()-30);const c=a.salesData.filter(d=>new Date(d.date)>=n),l=c.length>0?c.length/30:0,g=a.productionData.filter(d=>new Date(d.date)>=n),f={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0};g.forEach(d=>{f.chicken+=d.chickenMomos?.final||0,f.chickenCheese+=d.chickenCheeseMomos?.final||0,f.veg+=d.vegMomos?.final||0,f.cheeseCorn+=d.cheeseCornMomos?.final||0,f.paneer+=d.paneerMomos?.final||0,f.vegKurkure+=d.vegKurkureMomos?.final||0,f.chickenKurkure+=d.chickenKurkureMomos?.final||0});const j=Object.fromEntries(Object.entries(f).map(([d,h])=>[d,g.length>0?h/30:0])),o=7,m=[];for(let d=1;d<=o;d++){const h=new Date;h.setDate(h.getDate()+d);const N=h.getDay(),u=N===0||N===6?1.3:1;m.push({date:h.toISOString().split("T")[0],dayName:h.toLocaleDateString("en-US",{weekday:"short"}),expectedDemand:Math.round(l*u*100),recommendedProduction:Math.round(l*u*110),isWeekend:N===0||N===6})}const y=t.map(d=>{const N=a.stockRequests.filter(x=>x.storeId===d.id&&x.status==="fulfilled").reduce((x,E)=>x+(E.fulfilledQuantities?Object.values(E.fulfilledQuantities).reduce((v,I)=>v+I,0):0),0),p=a.salesData.filter(x=>x.storeId===d.id&&new Date(x.date)>=n).length/30,b=p>0?N/(p*10):99;let P="low";return b<2?P="critical":b<4?P="high":b<7&&(P="medium"),{storeName:d.name,currentStock:N,avgDailySales:Math.round(p*10),daysUntilStockout:Math.round(b),riskLevel:P,recommendedOrder:Math.round(p*10*7)}}),M=Object.entries(j).map(([d,h])=>{const N=h,u=Math.round(N*1.15),p=N>0?85:0;return{product:d.replace(/([A-Z])/g," $1").trim(),current:Math.round(N),recommended:u,efficiency:p,status:N>=u*.9?"optimal":"increase_needed"}}).filter(d=>d.current>0||d.recommended>0),S=[];for(let d=0;d<6;d++){const h=new Date;h.setMonth(h.getMonth()-(5-d));const N=a.salesData.filter(u=>{const p=new Date(u.date);return p.getMonth()===h.getMonth()&&p.getFullYear()===h.getFullYear()}).reduce((u,p)=>u+(p.onlineSales||0)+(p.offlineSales||0),0);S.push({month:h.toLocaleDateString("en-US",{month:"short"}),sales:N})}return{forecast:m,storeRisks:y,optimalSchedule:M,monthlyTrend:S,avgDailyProductionByType:j}},[a,t]),s=n=>{switch(n){case"critical":return"bg-red-100 text-red-800 border-red-300";case"high":return"bg-orange-100 text-orange-800 border-orange-300";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"low":return"bg-green-100 text-green-800 border-green-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx(be,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl",children:"Predictive Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"AI-powered forecasting and recommendations"})]})]}),e.jsxs(R,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg mb-4 flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5 text-purple-600"}),"7-Day Demand Forecast"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-3",children:r.forecast.map(n=>e.jsxs("div",{className:`p-4 rounded-lg border-2 ${n.isWeekend?"bg-purple-50 border-purple-200":"bg-gray-50 border-gray-200"}`,children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:n.dayName}),e.jsx("p",{className:"text-sm mb-2",children:new Date(n.date).getDate()}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Expected"}),e.jsx("p",{className:"text-lg",children:n.expectedDemand})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600",children:"Recommended"}),e.jsx("p",{className:"text-lg text-green-600",children:n.recommendedProduction})]})]})]},n.date))})]}),e.jsxs(R,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg mb-4 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-orange-600"}),"Stock-out Risk by Store"]}),e.jsx("div",{className:"space-y-3",children:r.storeRisks.map(n=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm",children:n.storeName}),e.jsxs(oe,{className:`${s(n.riskLevel)} border`,children:[n.riskLevel.toUpperCase()," RISK"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Current Stock"}),e.jsx("p",{className:"text-lg",children:n.currentStock})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Avg Daily Sales"}),e.jsx("p",{className:"text-lg",children:n.avgDailySales})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Days Until Stock-out"}),e.jsx("p",{className:`text-lg ${n.daysUntilStockout<3?"text-red-600":n.daysUntilStockout<7?"text-orange-600":"text-green-600"}`,children:n.daysUntilStockout})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Recommended Order"}),e.jsx("p",{className:"text-lg text-blue-600",children:n.recommendedOrder})]})]})]},n.storeName))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{className:"p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:"Weekly Demand Forecast"}),e.jsx(ae,{width:"100%",height:300,children:e.jsxs(Ee,{data:r.forecast,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(xe,{dataKey:"dayName",tick:{fontSize:12}}),e.jsx(se,{tick:{fontSize:12}}),e.jsx(fe,{}),e.jsx(re,{}),e.jsx(ne,{dataKey:"expectedDemand",fill:"#8b5cf6",name:"Expected"}),e.jsx(ne,{dataKey:"recommendedProduction",fill:"#10b981",name:"Recommended"})]})})]}),e.jsxs(R,{className:"p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:"6-Month Sales Trend"}),e.jsx(ae,{width:"100%",height:300,children:e.jsxs(Ye,{data:r.monthlyTrend,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(xe,{dataKey:"month",tick:{fontSize:12}}),e.jsx(se,{tick:{fontSize:12}}),e.jsx(fe,{}),e.jsx(re,{}),e.jsx(Ze,{type:"monotone",dataKey:"sales",stroke:"#ec4899",strokeWidth:2,name:"Sales (â‚¹)"})]})})]})]}),e.jsxs(R,{className:"p-6",children:[e.jsxs("h3",{className:"text-lg mb-4 flex items-center gap-2",children:[e.jsx($e,{className:"h-5 w-5 text-blue-600"}),"Optimal Production Schedule"]}),e.jsx("div",{className:"space-y-3",children:r.optimalSchedule.map(n=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm capitalize",children:n.product}),e.jsx(oe,{className:n.status==="optimal"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800",children:n.status==="optimal"?"OPTIMAL":"INCREASE NEEDED"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Current"}),e.jsxs("span",{children:[n.current,"/day"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500",style:{width:`${n.current/n.recommended*100}%`}})})]}),e.jsx(ct,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{className:"w-24 text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Target"}),e.jsx("p",{className:"text-lg text-green-600",children:n.recommended})]})]})]},n.product))})]})]})}function Ft({context:a,stores:t}){const[r,s]=T.useState("score"),[n,c]=T.useState("30days"),l=T.useMemo(()=>{const o=n==="7days"?7:n==="30days"?30:90,m=new Date;m.setDate(m.getDate()-o);const y=new Date;y.setDate(y.getDate()-o*2);const M=new Date(m),S=t.map(d=>{const h=a.salesData.filter(w=>w.storeId===d.id&&new Date(w.date)>=m).reduce((w,K)=>w+(K.onlineSales||0)+(K.offlineSales||0),0),N=a.salesData.filter(w=>w.storeId===d.id&&new Date(w.date)>=y&&new Date(w.date)<M).reduce((w,K)=>w+(K.onlineSales||0)+(K.offlineSales||0),0),u=N>0?(h-N)/N*100:h>0?100:0,p=a.stockRequests.filter(w=>w.storeId===d.id&&new Date(w.requestDate)>=m),b=p.length,P=p.filter(w=>w.status==="fulfilled"||w.status==="partially_fulfilled"),x=p.reduce((w,K)=>w+Object.values(K.requestedQuantities).reduce((U,i)=>U+i,0),0),E=P.reduce((w,K)=>w+(K.fulfilledQuantities?Object.values(K.fulfilledQuantities).reduce((U,i)=>U+i,0):0),0),v=x>0?E/x*100:0,I=b>0?x/b:0,_=E>0?h/E*(v/100):0,k=Math.min(h/1e5*100,100),A=v,O=Math.max(0,Math.min(u+50,100)),H=Math.min(_,100),X=k*.35+A*.25+O*.25+H*.15;return{storeId:d.id,storeName:d.name,totalSales:h,totalRequests:b,fulfillmentRate:v,avgRequestSize:I,salesGrowth:u,efficiency:_,overallScore:X,rank:0}});return S.sort((d,h)=>h.overallScore-d.overallScore),S.forEach((d,h)=>{d.rank=h+1}),r==="sales"?S.sort((d,h)=>h.totalSales-d.totalSales):r==="efficiency"&&S.sort((d,h)=>h.efficiency-d.efficiency),S},[a,t,n,r]),g=T.useMemo(()=>{const o=l.slice(0,3);return[{metric:"Sales",...Object.fromEntries(o.map(m=>[m.storeName,Math.min(m.totalSales/1e5*100,100)]))},{metric:"Fulfillment",...Object.fromEntries(o.map(m=>[m.storeName,m.fulfillmentRate]))},{metric:"Growth",...Object.fromEntries(o.map(m=>[m.storeName,Math.max(0,Math.min(m.salesGrowth+50,100))]))},{metric:"Efficiency",...Object.fromEntries(o.map(m=>[m.storeName,Math.min(m.efficiency,100)]))},{metric:"Requests",...Object.fromEntries(o.map(m=>[m.storeName,Math.min(m.totalRequests/10*100,100)]))}]},[l]),f=o=>o===1?{icon:ve,color:"bg-yellow-100 text-yellow-800 border-yellow-300",label:"ðŸ¥‡ 1st"}:o===2?{icon:Se,color:"bg-gray-100 text-gray-800 border-gray-300",label:"ðŸ¥ˆ 2nd"}:o===3?{icon:Se,color:"bg-orange-100 text-orange-800 border-orange-300",label:"ðŸ¥‰ 3rd"}:{icon:be,color:"bg-blue-100 text-blue-800 border-blue-300",label:`#${o}`},j=l.map(o=>({name:o.storeName,sales:o.totalSales,score:o.overallScore}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:e.jsx(ve,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl",children:"Store Performance Comparison"}),e.jsx("p",{className:"text-muted-foreground",children:"Compare and rank store performance metrics"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:n,onChange:o=>c(o.target.value),className:"px-4 py-2 border rounded-lg bg-background",children:[e.jsx("option",{value:"7days",children:"Last 7 Days"}),e.jsx("option",{value:"30days",children:"Last 30 Days"}),e.jsx("option",{value:"90days",children:"Last 90 Days"})]}),e.jsxs("select",{value:r,onChange:o=>s(o.target.value),className:"px-4 py-2 border rounded-lg bg-background",children:[e.jsx("option",{value:"score",children:"Overall Score"}),e.jsx("option",{value:"sales",children:"Total Sales"}),e.jsx("option",{value:"efficiency",children:"Efficiency"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:l.slice(0,3).map((o,m)=>{const y=f(o.rank),M=y.icon;return e.jsxs(R,{className:"p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-purple-500/10 to-pink-500/10 rounded-bl-full"}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(oe,{className:`${y.color} border text-lg px-3 py-1`,children:y.label}),e.jsx(M,{className:"h-8 w-8 text-purple-600"})]}),e.jsx("h3",{className:"text-xl mb-4",children:o.storeName}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Overall Score"}),e.jsxs("span",{className:"text-purple-600",children:[o.overallScore.toFixed(1),"/100"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sales"}),e.jsxs("span",{children:["â‚¹",o.totalSales.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Growth"}),e.jsxs("span",{className:o.salesGrowth>=0?"text-green-600":"text-red-600",children:[o.salesGrowth>=0?e.jsx(rt,{className:"inline h-4 w-4"}):e.jsx(qe,{className:"inline h-4 w-4"}),Math.abs(o.salesGrowth).toFixed(1),"%"]})]})]})]})]},o.storeId)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(R,{className:"p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:"Multi-dimensional Performance (Top 3)"}),e.jsx(ae,{width:"100%",height:350,children:e.jsxs(Lt,{data:g,children:[e.jsx(Te,{}),e.jsx(Ae,{dataKey:"metric",tick:{fontSize:12}}),e.jsx(Re,{angle:90,domain:[0,100],tick:{fontSize:10}}),e.jsx(B,{name:l[0]?.storeName,dataKey:l[0]?.storeName,stroke:"#8b5cf6",fill:"#8b5cf6",fillOpacity:.6}),l[1]&&e.jsx(B,{name:l[1].storeName,dataKey:l[1].storeName,stroke:"#ec4899",fill:"#ec4899",fillOpacity:.6}),l[2]&&e.jsx(B,{name:l[2].storeName,dataKey:l[2].storeName,stroke:"#10b981",fill:"#10b981",fillOpacity:.6}),e.jsx(re,{})]})})]}),e.jsxs(R,{className:"p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:"Sales & Performance Score"}),e.jsx(ae,{width:"100%",height:350,children:e.jsxs(Ee,{data:j,children:[e.jsx(ge,{strokeDasharray:"3 3"}),e.jsx(xe,{dataKey:"name",tick:{fontSize:12},angle:-45,textAnchor:"end",height:100}),e.jsx(se,{yAxisId:"left",tick:{fontSize:12}}),e.jsx(se,{yAxisId:"right",orientation:"right",tick:{fontSize:12}}),e.jsx(fe,{}),e.jsx(re,{}),e.jsx(ne,{yAxisId:"left",dataKey:"sales",fill:"#8b5cf6",name:"Sales (â‚¹)"}),e.jsx(ne,{yAxisId:"right",dataKey:"score",fill:"#ec4899",name:"Score"})]})})]})]}),e.jsxs(R,{className:"p-6",children:[e.jsx("h3",{className:"text-lg mb-4",children:"Detailed Performance Metrics"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-2",children:"Rank"}),e.jsx("th",{className:"text-left py-3 px-2",children:"Store"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Score"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Sales"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Growth"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Requests"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Fulfillment"}),e.jsx("th",{className:"text-right py-3 px-2",children:"Efficiency"})]})}),e.jsx("tbody",{children:l.map(o=>{const m=f(o.rank);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-2",children:e.jsx(oe,{className:`${m.color} border text-xs`,children:m.label})}),e.jsx("td",{className:"py-3 px-2",children:o.storeName}),e.jsx("td",{className:"text-right py-3 px-2",children:e.jsx("span",{className:"text-purple-600",children:o.overallScore.toFixed(1)})}),e.jsxs("td",{className:"text-right py-3 px-2",children:["â‚¹",o.totalSales.toLocaleString()]}),e.jsx("td",{className:"text-right py-3 px-2",children:e.jsxs("span",{className:o.salesGrowth>=0?"text-green-600":"text-red-600",children:[o.salesGrowth>=0?"+":"",o.salesGrowth.toFixed(1),"%"]})}),e.jsx("td",{className:"text-right py-3 px-2",children:o.totalRequests}),e.jsx("td",{className:"text-right py-3 px-2",children:e.jsxs("span",{className:o.fulfillmentRate>=90?"text-green-600":o.fulfillmentRate>=70?"text-yellow-600":"text-red-600",children:[o.fulfillmentRate.toFixed(1),"%"]})}),e.jsx("td",{className:"text-right py-3 px-2",children:o.efficiency.toFixed(1)})]},o.storeId)})})]})})]})]})}function Bt({context:a,productionHouses:t,onNavigateToManageItems:r}){const[s,n]=T.useState(new Date().toISOString().split("T")[0]),[c,l]=T.useState(null),[g,f]=T.useState([]),[j,o]=T.useState(!0),[m,y]=T.useState({}),M=async()=>{try{const u=et(),{data:{session:p}}=await u.auth.getSession();return p?.access_token||null}catch(u){return console.error("Error getting fresh token:",u),null}};T.useEffect(()=>{(async()=>{const p=await M();if(!p){console.error("No access token available"),o(!1);return}try{const b=await Xe(p);f(b)}catch(b){console.error("Error loading production requests:",b)}finally{o(!1)}})()},[]),T.useEffect(()=>{const u=async()=>{const p=await M();if(!p)return;console.log("ðŸ”„ Loading production house opening balances..."),console.log("  Production houses count:",t.length),console.log("  Inventory items count:",a.inventoryItems?.length||0);const b=new Date().toISOString().substring(0,7),P={};for(const x of t){console.log(`  Fetching recalibration for ${x.name} (${x.id})...`);try{const E=await Je(p,x.id,"production_house");if(console.log(`  Recalibration response for ${x.name}:`,E),E?.record){const v=E.record.date.substring(0,7);if(console.log(`  Recalibration date: ${v}, Current month: ${b}`),v===b){const I={};E.record.items.forEach(_=>{const k=a.inventoryItems?.find(A=>A.id===_.itemId||A.name===_.itemId);if(console.log(`    Item ${_.itemId}: ${k?"Found":"NOT FOUND"}`,k),k){const A=k.name.replace(/_([a-z])/g,O=>O[1].toUpperCase());I[A]=_.actualQuantity,console.log(`    Mapped to ${A} = ${_.actualQuantity}`)}}),P[x.id]=I,console.log(`âœ… Loaded opening balance for ${x.name}:`,I)}else console.log(`  âš ï¸ Recalibration month ${v} doesn't match current month ${b}`)}else console.log(`  â„¹ï¸ No recalibration found for ${x.name}`)}catch(E){console.error(`âŒ Error fetching recalibration for ${x.name}:`,E)}}console.log("ðŸ Final opening balances:",P),y(P)};t.length>0&&a.inventoryItems&&a.inventoryItems.length>0?u():console.log("âš ï¸ Skipping opening balance load:",{productionHousesCount:t.length,inventoryItemsCount:a.inventoryItems?.length||0})},[t,a.inventoryItems]);const S=T.useMemo(()=>{if(j)return[];const u=[];return console.log("ðŸ­ Production Houses:",t),console.log("ðŸ“¦ Production Requests:",g),console.log("ðŸ“… Selected Date:",s),t.forEach(p=>{console.log(`
ðŸ­ Processing house: ${p.name} (${p.id})`);const b=a.productionData.filter(i=>i.productionHouseId===p.id&&i.date<=s),P=g?.filter(i=>{if(!i.deliveredAt||i.status!=="delivered")return!1;let D;if(i.deliveredAt.includes("/")){const V=i.deliveredAt.split(",")[0].split("/");D=`${V[2]}-${V[1].padStart(2,"0")}-${V[0].padStart(2,"0")}`}else i.deliveredAt.includes("T")?D=i.deliveredAt.split("T")[0]:D=i.deliveredAt.split(" ")[0];const de=a.stores.find(V=>V.id===i.storeId),F=de?.productionHouseId===p.id,je=D<=s;return console.log(`    ðŸ“¦ Request ${i.id}: storeId=${i.storeId}, store.productionHouseId=${de?.productionHouseId}, houseId=${p.id}, deliveredDate=${D}, isForThisHouse=${F}, isBeforeOrOnDate=${je}, status=${i.status}`),F&&je})||[];console.log(`  âœ… Total delivered requests for ${p.name}: ${P.length}`),P.forEach(i=>{console.log(`    - Request: chicken=${i.chickenMomos}, chickenCheese=${i.chickenCheeseMomos}, deliveredAt=${i.deliveredAt}`)});const x=a.productionData.find(i=>i.productionHouseId===p.id&&i.date===s),E=g?.filter(i=>{if(!i.deliveredAt||i.status!=="delivered")return!1;let D;if(i.deliveredAt.includes("/")){const F=i.deliveredAt.split(",")[0].split("/");D=`${F[2]}-${F[1].padStart(2,"0")}-${F[0].padStart(2,"0")}`}else i.deliveredAt.includes("T")?D=i.deliveredAt.split("T")[0]:D=i.deliveredAt.split(" ")[0];return a.stores.find(F=>F.id===i.storeId)?.productionHouseId===p.id&&D===s})||[],v={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0,schezwan:0},I=m[p.id]||{},_={chickenMomo:"chicken",chickenCheeseMomo:"chickenCheese",vegMomo:"veg",cheeseCornMomo:"cheeseCorn",paneerMomo:"paneer",vegKurkureMomo:"vegKurkure",chickenKurkureMomo:"chickenKurkure",schezwanMomo:"schezwan"};Object.keys(I).forEach(i=>{const D=_[i]||i;D in v&&(v[D]=I[i],console.log(`  ðŸ“¦ Applied opening balance: ${i} -> ${D} = ${I[i]}`))}),b.forEach(i=>{v.chicken+=i.chickenMomos?.final||0,v.chickenCheese+=i.chickenCheeseMomos?.final||0,v.veg+=i.vegMomos?.final||0,v.cheeseCorn+=i.cheeseCornMomos?.final||0,v.paneer+=i.paneerMomos?.final||0,v.vegKurkure+=i.vegKurkureMomos?.final||0,v.chickenKurkure+=i.chickenKurkureMomos?.final||0,v.schezwan+=i.schezwanMomos?.final||0});const k={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0,schezwan:0};P.forEach(i=>{k.chicken+=i.chickenMomos||0,k.chickenCheese+=i.chickenCheeseMomos||0,k.veg+=i.vegMomos||0,k.cheeseCorn+=i.cheeseCornMomos||0,k.paneer+=i.paneerMomos||0,k.vegKurkure+=i.vegKurkureMomos||0,k.chickenKurkure+=i.chickenKurkureMomos||0,k.schezwan+=i.schezwanMomos||0});const A={chicken:x?.chickenMomos?.final||0,chickenCheese:x?.chickenCheeseMomos?.final||0,veg:x?.vegMomos?.final||0,cheeseCorn:x?.cheeseCornMomos?.final||0,paneer:x?.paneerMomos?.final||0,vegKurkure:x?.vegKurkureMomos?.final||0,chickenKurkure:x?.chickenKurkureMomos?.final||0,schezwan:x?.schezwanMomos?.final||0},O={chicken:0,chickenCheese:0,veg:0,cheeseCorn:0,paneer:0,vegKurkure:0,chickenKurkure:0,schezwan:0};E.forEach(i=>{O.chicken+=i.chickenMomos||0,O.chickenCheese+=i.chickenCheeseMomos||0,O.veg+=i.vegMomos||0,O.cheeseCorn+=i.cheeseCornMomos||0,O.paneer+=i.paneerMomos||0,O.vegKurkure+=i.vegKurkureMomos||0,O.chickenKurkure+=i.chickenKurkureMomos||0,O.schezwan+=i.schezwanMomos||0});const H={chicken:{produced:A.chicken,sent:O.chicken,available:Math.max(0,v.chicken-k.chicken),percentage:0},chickenCheese:{produced:A.chickenCheese,sent:O.chickenCheese,available:Math.max(0,v.chickenCheese-k.chickenCheese),percentage:0},veg:{produced:A.veg,sent:O.veg,available:Math.max(0,v.veg-k.veg),percentage:0},cheeseCorn:{produced:A.cheeseCorn,sent:O.cheeseCorn,available:Math.max(0,v.cheeseCorn-k.cheeseCorn),percentage:0},paneer:{produced:A.paneer,sent:O.paneer,available:Math.max(0,v.paneer-k.paneer),percentage:0},vegKurkure:{produced:A.vegKurkure,sent:O.vegKurkure,available:Math.max(0,v.vegKurkure-k.vegKurkure),percentage:0},chickenKurkure:{produced:A.chickenKurkure,sent:O.chickenKurkure,available:Math.max(0,v.chickenKurkure-k.chickenKurkure),percentage:0},schezwan:{produced:A.schezwan,sent:O.schezwan,available:Math.max(0,v.schezwan-k.schezwan),percentage:0}};Object.keys(H).forEach(i=>{const D=H[i];v[i]>0?D.percentage=D.available/v[i]*100:D.percentage=0});const X=Object.values(A).reduce((i,D)=>i+D,0),w=x?(x.wastage?.dough||0)+(x.wastage?.stuffing||0)+(x.wastage?.batter||0)+(x.wastage?.coating||0):0,K=a.productionData.filter(i=>i.productionHouseId===p.id&&i.date===s&&i.approvalStatus==="approved").length,U=a.productionData.filter(i=>i.productionHouseId===p.id&&i.date===s&&i.approvalStatus==="pending").length;u.push({productionHouseId:p.id,productionHouseName:p.name,date:s,stock:H,totalProduced:X,totalWastage:w,approvedEntries:K,pendingApproval:U}),console.log(`  ðŸ“Š Stock entry created for ${p.name}:`,{totalProduced:X,totalWastage:w,availableStock:H,hasOpeningBalance:Object.keys(I).length>0,openingBalance:I})}),console.log("ðŸ Final stocks array:",u),u},[a.productionData,a.stores,g,t,s,m]),d=c?S.filter(u=>u.productionHouseId===c):S,h={chicken:"Chicken Momos",chickenCheese:"Chicken Cheese Momos",veg:"Veg Momos",cheeseCorn:"Cheese Corn Momos",paneer:"Paneer Momos",vegKurkure:"Veg Kurkure Momos",chickenKurkure:"Chicken Kurkure Momos",schezwan:"Schezwan Momos"},N=u=>u>=80?{bg:"bg-purple-50",border:"border-purple-200",bar:"bg-purple-500",text:"text-purple-700"}:u>=60?{bg:"bg-pink-50",border:"border-pink-200",bar:"bg-pink-500",text:"text-pink-700"}:u>=40?{bg:"bg-green-50",border:"border-green-200",bar:"bg-green-500",text:"text-green-700"}:u>=20?{bg:"bg-yellow-50",border:"border-yellow-200",bar:"bg-yellow-500",text:"text-yellow-700"}:{bg:"bg-red-50",border:"border-red-200",bar:"bg-red-500",text:"text-red-700"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(R,{className:"p-4 bg-gradient-to-r from-orange-50 to-amber-50 border-2 border-orange-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ut,{className:"w-5 h-5 text-orange-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-orange-900 mb-1",children:"Dynamic Inventory Items"}),e.jsxs("p",{className:"text-sm text-orange-700 mb-2",children:["You can now add custom production items beyond the default 7 momo types! Manage all items from the ",e.jsx("strong",{children:'"Manage Items"'})," page in the navigation."]}),e.jsx("p",{className:"text-xs text-orange-600",children:"ðŸ’¡ Items can be production house-specific or global (available to all facilities)"})]})]})}),e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl",children:"Production House Stock Status"}),e.jsx("p",{className:"text-muted-foreground",children:"Opening balance + This month produced - Sent to stores (delivered requests)"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"date",value:s,onChange:u=>n(u.target.value),max:new Date().toISOString().split("T")[0],className:"px-3 py-2 border rounded-lg bg-background"})]}),e.jsxs("select",{value:c||"all",onChange:u=>l(u.target.value==="all"?null:u.target.value),className:"px-4 py-2 border rounded-lg bg-background",children:[e.jsx("option",{value:"all",children:"All Production Houses"}),t.map(u=>e.jsx("option",{value:u.id,children:u.name},u.id))]}),r&&(a.user?.role==="manager"||a.user?.role==="cluster_head")&&e.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all shadow-md hover:shadow-lg",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-semibold",children:"Manage Items"})]})]})]}),d.map(u=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(R,{className:"p-6 bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ie,{className:"h-5 w-5 text-orange-600"}),e.jsx("p",{className:"text-sm text-orange-800",children:"Total Production"})]}),e.jsx("p",{className:"text-3xl text-orange-900 mb-1",children:u.totalProduced.toLocaleString()}),e.jsx("p",{className:"text-xs text-orange-700",children:"pieces"})]}),e.jsxs(R,{className:"p-6 bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(nt,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-sm text-red-800",children:"Total Wastage"})]}),e.jsx("p",{className:"text-3xl text-red-900 mb-1",children:u.totalWastage.toFixed(2)}),e.jsx("p",{className:"text-xs text-red-700",children:"kg"})]}),e.jsxs(R,{className:"p-6 bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx($e,{className:"h-5 w-5 text-green-600"}),e.jsx("p",{className:"text-sm text-green-800",children:"Approved Entries"})]}),e.jsx("p",{className:"text-3xl text-green-900 mb-1",children:u.approvedEntries}),e.jsx("p",{className:"text-xs text-green-700",children:"records"})]}),e.jsxs(R,{className:"p-6 bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(pe,{className:"h-5 w-5 text-yellow-600"}),e.jsx("p",{className:"text-sm text-yellow-800",children:"Pending Approval"})]}),e.jsx("p",{className:"text-3xl text-yellow-900 mb-1",children:u.pendingApproval}),e.jsx("p",{className:"text-xs text-yellow-700",children:"records"})]})]}),e.jsxs(R,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(we,{className:"h-5 w-5 text-orange-600"}),e.jsxs("h3",{className:"text-lg",children:[u.productionHouseName," - Stock Status"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Object.entries(u.stock).map(([p,b])=>{const P=N(b.percentage);return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${P.bg} ${P.border}`,children:[e.jsx("h4",{className:"text-sm mb-3",children:h[p]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"This Month Produced:"}),e.jsx("span",{className:P.text,children:b.produced})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent to Stores:"}),e.jsx("span",{className:"text-red-600",children:b.sent})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"",children:"Stock Available:"}),e.jsx("span",{className:`text-lg ${P.text}`,children:b.available})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"flex justify-between text-xs",children:e.jsxs("span",{children:[b.percentage.toFixed(0),"% remaining"]})}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${P.bar} transition-all duration-300`,style:{width:`${Math.min(b.percentage,100)}%`}})})]})]})]})]},p)})})]})]},u.productionHouseId)),d.length===0&&e.jsxs(R,{className:"p-12 text-center",children:[e.jsx(we,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg mb-2",children:"No Production Data"}),e.jsx("p",{className:"text-muted-foreground",children:"No production data available for the selected date and production house"})]})]})}function Qt({context:a,stores:t,onNavigateToManageItems:r}){const[s,n]=useState("dashboard");return e.jsx("div",{className:"min-h-screen bg-background p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl",children:"Advanced Inventory Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive inventory tracking, analytics, and reporting system"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-lg",children:e.jsx(ie,{className:"h-6 w-6 text-white"})})})]}),e.jsxs(Tabs,{value:s,onValueChange:c=>n(c),className:"space-y-6",children:[e.jsxs(TabsList,{className:"grid grid-cols-7 w-full",children:[e.jsxs(TabsTrigger,{value:"dashboard",className:"flex items-center gap-2",children:[e.jsx(tt,{className:"h-4 w-4"}),"Dashboard"]}),e.jsxs(TabsTrigger,{value:"stock-status",className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Stock"]}),e.jsxs(TabsTrigger,{value:"alerts",className:"flex items-center gap-2",children:[e.jsx(at,{className:"h-4 w-4"}),"Alerts"]}),e.jsxs(TabsTrigger,{value:"requests",className:"flex items-center gap-2",children:[e.jsx(it,{className:"h-4 w-4"}),"Requests"]}),e.jsxs(TabsTrigger,{value:"reports",className:"flex items-center gap-2",children:[e.jsx(st,{className:"h-4 w-4"}),"Reports"]}),e.jsxs(TabsTrigger,{value:"predictive",className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Forecast"]}),e.jsxs(TabsTrigger,{value:"performance",className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"Rankings"]})]}),e.jsx(TabsContent,{value:"dashboard",children:e.jsx(InventoryDashboard,{context:a,stores:t})}),e.jsx(TabsContent,{value:"stock-status",children:e.jsx(Bt,{context:a,productionHouses:a.productionHouses,onNavigateToManageItems:r})}),e.jsx(TabsContent,{value:"alerts",children:e.jsx(InventoryAlerts,{context:a,stores:t})}),e.jsx(TabsContent,{value:"requests",children:e.jsx(EnhancedProductionRequests,{context:a,stores:t})}),e.jsx(TabsContent,{value:"reports",children:e.jsx(ReportsVisualization,{context:a,stores:t})}),e.jsx(TabsContent,{value:"predictive",children:e.jsx(zt,{context:a,stores:t})}),e.jsx(TabsContent,{value:"performance",children:e.jsx(Ft,{context:a,stores:t})})]})]})})}export{Qt as AdvancedInventoryManagement};
